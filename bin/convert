#!/bin/bash

APP_DIR=${1:-src}

# COLORS! :)
red='\033[0;31m'
cyan='\033[0;36m'
blue='\033[0;34m'
yellow='\033[0;33m'
nocolor='\033[0m'

confirmYes() {
  echo ""
  msg="${1:-Are you sure?}"
  read -r -p "${msg} [Y/n] " response
  case "$response" in
    [nN][oO]|[nN])
      return 1
      ;;
    *)
      return 0
      ;;
  esac
}

error() {
  prefix="[ERROR] "
  echo -e "${red}${prefix}${1}${nocolor}"
}

warn() {
  prefix="[WARNING] "
  echo -e "${yellow}${prefix}${1}${nocolor}"
}

log() {
  prefix="[INFO] "
  echo -e "${cyan}${prefix}${1}${nocolor}"
}

processJsx() {
  file="$1"
  dest="${file%.jsx}.tsx"
  dest="${file%.js}.ts"

  log "Move file: $file => $dest"
}

processJs() {
  file="$1"

  if [[ ${file: -3} == ".js" ]]; then
    dest="${file%.js}.ts"
    log "JS EXT: $file"
  else
    dest="${file%.jsx}.tsx"
    warn "NOT JS EXT: $file"
  fi
  # dest="${file%.jsx}.tsx"
  # dest="${file%.js}.ts"

  log "Move file: $file => $dest"
}

processFile() {
  file="$1"
  dest="${file%.jsx}.tsx"
  dest="${file%.js}.ts"

  log "Move file: $file => $dest"
}

processDir() {
  dir=$1
  warn "Scan dir: $dir"

  for path in $dir/**; do
    if [[ -d $path ]]; then
      processDir $path
    else
      processJs $path
    fi
  done
}

processDir $APP_DIR
